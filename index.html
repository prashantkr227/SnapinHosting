<HTML>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
        <link rel="stylesheet" type="text/css" href="https://gsuat-vmware-gs--gsuat.cs77.force.com/LiveAgent/servlet/servlet.FileDownload?file=0150t0000005Unt&oid=00D0t0000000uDz" media="all"/>
    </head>
    <body>
        <script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
        <script type='text/javascript'>
            var initESW = function(gslbBaseURL) {
                embedded_svc.settings.displayHelpButton = true; //Or false
                embedded_svc.settings.language = 'en-US'; //For example, enter 'en' or 'en-US'
                
                embedded_svc.settings.defaultMinimizedText = 'Chat with Support'; //(Defaults to Chat with an Expert)
                embedded_svc.settings.disabledMinimizedText = 'Chat Support Offline'; //(Defaults to Agent Offline)
                
                embedded_svc.settings.loadingText = 'Loading...'; //(Defaults to Loading)
                //embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)
                
                // Settings for Live Agent
                //embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
                // Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
                // Returns a valid button ID.
                //};
                //embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
                //embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
                //embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)
                
                embedded_svc.settings.enabledFeatures = ['LiveAgent'];
                embedded_svc.settings.entryFeature = 'LiveAgent';
                
				var mailId= 'testing1243@testi.com';
				var firstName = 'Test1';
				var lastName = 'Test2';
				var phoneNumber='8888888888';
                var contEmail = mailId;
                
                
                /*Variables defined for details to be displayed only in the current detail page*/
                var caseRecType = 'GSS Technical Support';
				var caseEnt = 'SPS';
				var caseProduct = 'VMware Cloud on AWS';
                
                /*Variables defined for Case details*/
                var caseOrigin = 'Portal Chat';
                var caseStatus = 'Open';
                var caseSubStatus = 'Assigned';
                var caseDesc = 'Case created from Chat';
                var caseSubj = 'Case created from Chat';
                var caseSupLev = '1';
				var caseProbCat = 'Storage';
                var caseSev = 'S3';
                var casePriority = '3 - Medium';
				var caseEANumber = '12345';
                var caseRecTypeId = '0120t0000008hey';
                var dcaId='0010t00001CfyO3AAJ';
				var portalSession = '<Portal Session ID>';
                
				var accountName = '<Account Name>';
                
            /*Details to be displayed in the current detail page*/
                embedded_svc.settings.extraPrechatFormDetails = [
                    {"label": "First Name", "value": firstName, "displayToAgent": true,"transcriptFields":["First_Name__c"]},
                    {"label": "Last Name", "value": lastName, "displayToAgent": true,"transcriptFields":["Last_Name__c"]},
                    {"label": "Email Id", "value": contEmail, "displayToAgent": true,"transcriptFields":["Contact_Email__c"]},
                    {"label": "Contact Phone Number", "value": phoneNumber, "displayToAgent": true,"transcriptFields":["Contact_Phone__c"]},
                    {"label": "Case Product", "value": caseProduct, "displayToAgent": true,"transcriptFields":["Case_Product__c"]},
                    {"label": "Case Severity", "value": caseSev, "displayToAgent": true,"transcriptFields":["Case_Severity__c"]},
                    {"label": "Case Problem Category", "value": caseProbCat, "displayToAgent": true,"transcriptFields":["Case_Problem_Category__c"]},
                    {"label": "Case Entitlement", "value": caseEnt, "displayToAgent": true,"transcriptFields":["Case_Entitlement__c"]},
                    {"label": "Case Support Level", "value": caseSupLev, "displayToAgent": true,"transcriptFields":["Case_Support_Level__c"]},
                    {"label": "Case Record Type", "value": caseRecType, "displayToAgent": true,"transcriptFields":["Case_Record_Type__c"]},
                    {"label": "Case Origin", "value": caseOrigin, "displayToAgent": true,"transcriptFields":["Case_Origin__c"]},
                    {"label": "Case Status", "value": caseStatus, "displayToAgent": true,"transcriptFields":["Case_Status__c"]},
                    {"label": "Case Sub Status", "value": caseSubStatus, "displayToAgent": true,"transcriptFields":["Case_Sub_Status__c"]},
                    {"label": "Case Subject", "value": caseSubj, "displayToAgent": true,"transcriptFields":["Case_Subject__c"]},
                    {"label": "Case Description", "value": caseDesc, "displayToAgent": true,"transcriptFields":["Case_Description__c"]},
                    {"label": "Case EA Number", "value": caseEANumber, "displayToAgent": true,"transcriptFields":["Case_EA_Number__c"]},
                    {"label": "Case RecordTypeId", "value": caseRecTypeId, "displayToAgent": false},
                    {"label": "DCA Account ID", "value": dcaId, "displayToAgent": false},
                    {"label": "Portal Session ID", "value": portalSession, "displayToAgent": false,"transcriptFields":["Portal_Session_ID__c"]},
                    {"label": "Account Name", "value": accountName, "displayToAgent": true,"transcriptFields":["Account_Name__c"]},
                    {"label": "Case Priority", "value": casePriority, "displayToAgent": true,"transcriptFields":["Case_Priority__c"]}
                ];
                
                /*Maps the value with Case fields and creates a Case and also links to chat based on whether contact is null, existing or a user*/
                if(contEmail != '' || contEmail != null){
                    embedded_svc.settings.extraPrechatInfo = [{
                        "entityFieldMaps": [
                            {"doCreate":true, "doFind":true, "fieldName":"Email", "isExactMatch":true, "label":"Email Id"},
                            {"doCreate":true, "doFind":false, "fieldName":"FirstName", "isExactMatch":false, "label":"First Name"},
                            {"doCreate":true, "doFind":false, "fieldName":"LastName", "isExactMatch":false, "label":"Last Name"},
                            {"doCreate":true, "doFind":false, "fieldName":"Phone", "isExactMatch":false, "label":"Contact Phone Number"},
                            {"doCreate":true, "doFind":false, "fieldName":"AccountId", "isExactMatch":false, "label":"DCA Account ID"}
                        ],
                        "entityName":"Contact",
                        "saveToTranscript": "ContactId",
                        "showOnCreate": true
                    },
                                                              {
                                                                  "entityFieldMaps": [
                                                                      {"doCreate": false,"doFind": true,"fieldName": "ContactEmail","isExactMatch": true,"label": "Email Id"},
                                                                      {"doCreate": false,"doFind": true,"fieldName": "Origin","isExactMatch": false,"label": "Case Origin"},
                                                                      {"doCreate": false,"doFind": true,"fieldName": "Status","isExactMatch": false,"label": "Case Status"},
                                                                      {"doCreate": false,"doFind": true,"fieldName": "RecordTypeId","isExactMatch": false,"label": "Case RecordTypeId"}
                                                                  ],
                                                                  "entityName": "Case"
                                                              }];
                }
                
                embedded_svc.init(
                'https://vmware-gs--gsuat.cs77.my.salesforce.com',
                'https://gsuat-vmware-gs--gsuat.cs77.force.com/LiveAgent',
                gslbBaseURL,
                '00D0t0000000uDz',
                'EPG',
                {
                    baseLiveAgentContentURL: 'https://c.la2-c2cs-ord.salesforceliveagent.com/content',
                    deploymentId: '5720t0000008ORv',
                    buttonId: '5730t0000008OSA',
                    baseLiveAgentURL: 'https://d.la2-c2cs-ord.salesforceliveagent.com/chat',
                    eswLiveAgentDevName: 'EmbeddedServiceLiveAgent_Parent04I0t000000003ZEAQ_169c4f0fbb3',
                    isOfflineSupportEnabled: false
                }
            );
        };

        if (!window.embedded_svc) {
            var s = document.createElement('script');
            s.setAttribute('src', 'https://vmware-gs--gsuat.cs77.my.salesforce.com/embeddedservice/5.0/esw.min.js');
            s.onload = function() {
                initESW(null);
            };
            document.body.appendChild(s);
        } else {
            initESW('https://service.force.com');
        }
        </script>
    </body>
</HTML>
